DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (147,)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
DEBUG: Pushing state type: <class 'dict'>
DEBUG: State keys: ['pursuer_0', 'pursuer_1', 'pursuer_2', 'pursuer_3', 'pursuer_4', 'pursuer_5', 'pursuer_6', 'pursuer_7']
DEBUG: First agent state shape: (7, 7, 3)
Traceback (most recent call last):
  File "train.py", line 55, in <module>
    train()
  File "train.py", line 45, in train
    maddpg.update(replay_buffer, batch_size)
  File "/home/sricharan/Desktop/marl/marl_agents/maddpg_algorithm.py", line 108, in update
    states = {agent: np.array(states[agent], dtype=np.float32) for agent in self.env.agents}
  File "/home/sricharan/Desktop/marl/marl_agents/maddpg_algorithm.py", line 108, in <dictcomp>
    states = {agent: np.array(states[agent], dtype=np.float32) for agent in self.env.agents}
TypeError: list indices must be integers or slices, not str
